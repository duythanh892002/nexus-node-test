name: Nexus Node Auto Runner

on:
  workflow_dispatch:        # Cho phép bạn bấm chạy thủ công nếu muốn
  schedule:
    - cron: "0 */6 * * *"   # ⏰ Tự động chạy lại mỗi 6 giờ (UTC)

jobs:
  run-node:
    runs-on: ubuntu-latest

    steps:
      - name: 🚀 Starting Nexus Testnet Node
        run: |
          echo "***************************************"
          echo "🚀 Starting Nexus Testnet Node"
          echo "🆔 Node ID: 25642744"
          echo "🌐 Network: testnet"
          echo "***************************************"

          # Cài Docker
          sudo apt-get update -y
          sudo apt-get install -y docker.io

          # Đăng nhập Docker nếu cần (bỏ qua nếu public)
          # echo "${{ secrets.DOCKER_USERNAME }}" | docker login -u "${{ secrets.DOCKER_USERNAME }}" --password-stdin

          # Chạy container Nexus Node (giả định image có sẵn)
          docker run -d --name nexus-testnet \
            -e NODE_ID=25642744 \
            nexuschain/nexus-node:latest || true

          echo "✅ Node is now running... (will run for 6 hours)"
          sleep 21600  # 6 giờ = 21600 giây

          echo "🛑 Stopping container after 6 hours..."
          docker stop nexus-testnet || true
          docker rm nexus-testnet || true

          echo "✅ Finished one 6-hour session. Next run will start automatically in 6 hours."
